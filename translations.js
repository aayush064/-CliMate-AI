// CliMate AI - Multilingual Translation System
// Comprehensive translation data for climate education platform

const translations = {
    // English (Default)
    en: {
        // Navigation and Header
        'nav.stories': 'Stories',
        'nav.impact': 'Impact',
        'nav.learn': 'Learn',
        'nav.community': 'Community',
        
        // Hero Section
        'hero.title': 'Discover Your Climate Story with AI',
        'hero.subtitle': 'Get personalized climate education, track your environmental impact, and join a community of climate champions',
        'hero.cta': 'Start Your Climate Journey',
        
        // Storyteller Section
        'storyteller.title': 'AI Climate Storyteller',
        'storyteller.description': 'Get personalized climate stories based on your location and interests',
        'storyteller.location.label': 'Your Location',
        'storyteller.location.placeholder': 'Enter your city or allow location access',
        'storyteller.interests.label': 'What interests you most?',
        'storyteller.age.label': 'Age Group',
        'storyteller.generate': 'Generate My Climate Story',
        'storyteller.placeholder': 'Your personalized climate story will appear here...',
        'storyteller.loading': 'Creating your personalized climate story...',
        'storyteller.error': 'Sorry, I couldn\'t generate your story right now. Please try again.',
        
        // Interests
        'interests.renewable': 'Renewable Energy',
        'interests.ocean': 'Ocean Conservation',
        'interests.forest': 'Forest Protection',
        'interests.sustainable': 'Sustainable Living',
        'interests.science': 'Climate Science',
        'interests.wildlife': 'Wildlife Protection',
        
        // Age Groups
        'age.young': '13-15 years',
        'age.teen': '16-18 years',
        'age.young-adult': '19-25 years',
        'age.educator': 'I\'m an educator',
        
        // Actions
        'actions.share': 'Share Story',
        'actions.save': 'Save Story',
        'actions.more': 'More Stories',
        'actions.walked': 'Walked instead of driving',
        'actions.recycled': 'Recycled waste',
        'actions.energy': 'Used energy-efficient appliances',
        'actions.water': 'Conserved water',
        'actions.plant': 'Planted a tree',
        'actions.public': 'Used public transport',
        
        // Impact Tracker
        'tracker.title': 'Your Climate Impact',
        'tracker.description': 'Track your daily actions and see their environmental impact',
        'tracker.carbon': 'COâ‚‚ Saved Today',
        'tracker.water': 'Water Conserved',
        'tracker.energy': 'Energy Saved',
        'tracker.score': 'Eco Score',
        'tracker.log.title': 'Log Your Climate Actions',
        'tracker.progress': 'Your Weekly Progress',
        
        // Learning Section
        'learn.title': 'Climate Learning Hub',
        'learn.description': 'Interactive lessons and quizzes powered by AI',
        'learn.basics': 'Climate Basics',
        'learn.solutions': 'Climate Solutions',
        'learn.impact': 'Global Impact',
        'learn.action': 'Take Action',
        'learn.current.title': 'Introduction to Climate Change',
        'learn.current.intro': 'Climate change refers to long-term shifts in global temperatures and weather patterns. While natural variations occur, scientific evidence shows that human activities since the Industrial Revolution have been the primary driver of recent climate changes.',
        'learn.quiz': 'Take Quiz',
        'learn.next': 'Next Lesson',
        
        // Community Section
        'community.title': 'Climate Champions Community',
        'community.description': 'Connect with peers and share your climate journey',
        'community.leaderboard': 'ðŸ† Top Climate Champions',
        'community.challenges': 'ðŸŽ¯ Weekly Challenges',
        'community.share': 'Share Your Story',
        'community.share.placeholder': 'Share your climate action story with the community...',
        'community.share.btn': 'Share Story',
        
        // Challenges
        'challenges.bike': 'Bike to School Week',
        'challenges.bike.desc': 'Cycle instead of taking motorized transport',
        'challenges.plant': 'Plant for the Planet',
        'challenges.plant.desc': 'Help plant 1000 trees this month',
        
        // Chat Assistant
        'chat.welcome': 'Hi! I\'m your Climate AI assistant. Ask me anything about climate change, sustainability, or environmental action!',
        'chat.placeholder': 'Ask me about climate change...',
        'chat.thinking': 'Thinking...',
        'chat.error': 'Sorry, I couldn\'t process your message. Please try again.',
        
        // Weather and Climate Data
        'weather.temperature': 'Temperature',
        'weather.humidity': 'Humidity',
        'weather.condition': 'Condition',
        'weather.loading': 'Loading weather data...',
        'weather.error': 'Unable to load weather data',
        
        // Success Messages
        'success.story.shared': 'Your story has been shared with the community!',
        'success.story.saved': 'Story saved to your collection!',
        'success.action.logged': 'Great job! Your climate action has been logged.',
        'success.location.found': 'Location detected successfully!',
        
        // Error Messages
        'error.location.denied': 'Location access denied. Please enter your city manually.',
        'error.location.unavailable': 'Unable to determine your location.',
        'error.network': 'Network error. Please check your connection.',
        'error.general': 'Something went wrong. Please try again.',
    },
    
    // Spanish
    es: {
        // NavegaciÃ³n y Encabezado
        'nav.stories': 'Historias',
        'nav.impact': 'Impacto',
        'nav.learn': 'Aprender',
        'nav.community': 'Comunidad',
        
        // SecciÃ³n Principal
        'hero.title': 'Descubre Tu Historia ClimÃ¡tica con IA',
        'hero.subtitle': 'ObtÃ©n educaciÃ³n climÃ¡tica personalizada, rastrea tu impacto ambiental y Ãºnete a una comunidad de campeones del clima',
        'hero.cta': 'Comienza Tu Viaje ClimÃ¡tico',
        
        // SecciÃ³n del Narrador
        'storyteller.title': 'Narrador ClimÃ¡tico con IA',
        'storyteller.description': 'ObtÃ©n historias climÃ¡ticas personalizadas basadas en tu ubicaciÃ³n e intereses',
        'storyteller.location.label': 'Tu UbicaciÃ³n',
        'storyteller.location.placeholder': 'Ingresa tu ciudad o permite acceso a ubicaciÃ³n',
        'storyteller.interests.label': 'Â¿QuÃ© te interesa mÃ¡s?',
        'storyteller.age.label': 'Grupo de Edad',
        'storyteller.generate': 'Generar Mi Historia ClimÃ¡tica',
        'storyteller.placeholder': 'Tu historia climÃ¡tica personalizada aparecerÃ¡ aquÃ­...',
        'storyteller.loading': 'Creando tu historia climÃ¡tica personalizada...',
        'storyteller.error': 'Lo siento, no pude generar tu historia ahora. Por favor intenta de nuevo.',
        
        // Intereses
        'interests.renewable': 'EnergÃ­a Renovable',
        'interests.ocean': 'ConservaciÃ³n OceÃ¡nica',
        'interests.forest': 'ProtecciÃ³n Forestal',
        'interests.sustainable': 'Vida Sostenible',
        'interests.science': 'Ciencia ClimÃ¡tica',
        'interests.wildlife': 'ProtecciÃ³n de Vida Silvestre',
        
        // Grupos de Edad
        'age.young': '13-15 aÃ±os',
        'age.teen': '16-18 aÃ±os',
        'age.young-adult': '19-25 aÃ±os',
        'age.educator': 'Soy educador',
        
        // Acciones
        'actions.share': 'Compartir Historia',
        'actions.save': 'Guardar Historia',
        'actions.more': 'MÃ¡s Historias',
        'actions.walked': 'CaminÃ© en lugar de conducir',
        'actions.recycled': 'ReciclÃ© desechos',
        'actions.energy': 'UsÃ© electrodomÃ©sticos eficientes',
        'actions.water': 'ConservÃ© agua',
        'actions.plant': 'PlantÃ© un Ã¡rbol',
        'actions.public': 'UsÃ© transporte pÃºblico',
        
        // Rastreador de Impacto
        'tracker.title': 'Tu Impacto ClimÃ¡tico',
        'tracker.description': 'Rastrea tus acciones diarias y ve su impacto ambiental',
        'tracker.carbon': 'COâ‚‚ Ahorrado Hoy',
        'tracker.water': 'Agua Conservada',
        'tracker.energy': 'EnergÃ­a Ahorrada',
        'tracker.score': 'PuntuaciÃ³n Eco',
        'tracker.log.title': 'Registra Tus Acciones ClimÃ¡ticas',
        'tracker.progress': 'Tu Progreso Semanal',
        
        // SecciÃ³n de Aprendizaje
        'learn.title': 'Centro de Aprendizaje ClimÃ¡tico',
        'learn.description': 'Lecciones interactivas y cuestionarios impulsados por IA',
        'learn.basics': 'Conceptos BÃ¡sicos del Clima',
        'learn.solutions': 'Soluciones ClimÃ¡ticas',
        'learn.impact': 'Impacto Global',
        'learn.action': 'Tomar AcciÃ³n',
        'learn.current.title': 'IntroducciÃ³n al Cambio ClimÃ¡tico',
        'learn.current.intro': 'El cambio climÃ¡tico se refiere a cambios a largo plazo en las temperaturas globales y los patrones climÃ¡ticos. Aunque ocurren variaciones naturales, la evidencia cientÃ­fica muestra que las actividades humanas desde la RevoluciÃ³n Industrial han sido el principal impulsor de los cambios climÃ¡ticos recientes.',
        'learn.quiz': 'Tomar Cuestionario',
        'learn.next': 'Siguiente LecciÃ³n',
        
        // SecciÃ³n de Comunidad
        'community.title': 'Comunidad de Campeones ClimÃ¡ticos',
        'community.description': 'ConÃ©ctate con compaÃ±eros y comparte tu viaje climÃ¡tico',
        'community.leaderboard': 'ðŸ† Mejores Campeones ClimÃ¡ticos',
        'community.challenges': 'ðŸŽ¯ DesafÃ­os Semanales',
        'community.share': 'Comparte Tu Historia',
        'community.share.placeholder': 'Comparte tu historia de acciÃ³n climÃ¡tica con la comunidad...',
        'community.share.btn': 'Compartir Historia',
        
        // DesafÃ­os
        'challenges.bike': 'Semana de Bicicleta a la Escuela',
        'challenges.bike.desc': 'Usa bicicleta en lugar de transporte motorizado',
        'challenges.plant': 'Plantar por el Planeta',
        'challenges.plant.desc': 'Ayuda a plantar 1000 Ã¡rboles este mes',
        
        // Asistente de Chat
        'chat.welcome': 'Â¡Hola! Soy tu asistente de IA climÃ¡tica. Â¡PregÃºntame cualquier cosa sobre cambio climÃ¡tico, sostenibilidad o acciÃ³n ambiental!',
        'chat.placeholder': 'PregÃºntame sobre cambio climÃ¡tico...',
        'chat.thinking': 'Pensando...',
        'chat.error': 'Lo siento, no pude procesar tu mensaje. Por favor intenta de nuevo.',
        
        // Datos ClimÃ¡ticos y del Tiempo
        'weather.temperature': 'Temperatura',
        'weather.humidity': 'Humedad',
        'weather.condition': 'CondiciÃ³n',
        'weather.loading': 'Cargando datos del tiempo...',
        'weather.error': 'No se pueden cargar los datos del tiempo',
        
        // Mensajes de Ã‰xito
        'success.story.shared': 'Â¡Tu historia ha sido compartida con la comunidad!',
        'success.story.saved': 'Â¡Historia guardada en tu colecciÃ³n!',
        'success.action.logged': 'Â¡Excelente trabajo! Tu acciÃ³n climÃ¡tica ha sido registrada.',
        'success.location.found': 'Â¡UbicaciÃ³n detectada exitosamente!',
        
        // Mensajes de Error
        'error.location.denied': 'Acceso a ubicaciÃ³n denegado. Por favor ingresa tu ciudad manualmente.',
        'error.location.unavailable': 'No se puede determinar tu ubicaciÃ³n.',
        'error.network': 'Error de red. Por favor verifica tu conexiÃ³n.',
        'error.general': 'Algo saliÃ³ mal. Por favor intenta de nuevo.',
    },
    
    // French
    fr: {
        // Navigation et En-tÃªte
        'nav.stories': 'Histoires',
        'nav.impact': 'Impact',
        'nav.learn': 'Apprendre',
        'nav.community': 'CommunautÃ©',
        
        // Section Principale
        'hero.title': 'DÃ©couvrez Votre Histoire Climatique avec l\'IA',
        'hero.subtitle': 'Obtenez une Ã©ducation climatique personnalisÃ©e, suivez votre impact environnemental et rejoignez une communautÃ© de champions du climat',
        'hero.cta': 'Commencez Votre Parcours Climatique',
        
        // Section du Narrateur
        'storyteller.title': 'Narrateur Climatique IA',
        'storyteller.description': 'Obtenez des histoires climatiques personnalisÃ©es basÃ©es sur votre localisation et vos intÃ©rÃªts',
        'storyteller.location.label': 'Votre Localisation',
        'storyteller.location.placeholder': 'Entrez votre ville ou autorisez l\'accÃ¨s Ã  la localisation',
        'storyteller.interests.label': 'Qu\'est-ce qui vous intÃ©resse le plus ?',
        'storyteller.age.label': 'Groupe d\'Ã‚ge',
        'storyteller.generate': 'GÃ©nÃ©rer Mon Histoire Climatique',
        'storyteller.placeholder': 'Votre histoire climatique personnalisÃ©e apparaÃ®tra ici...',
        'storyteller.loading': 'CrÃ©ation de votre histoire climatique personnalisÃ©e...',
        'storyteller.error': 'DÃ©solÃ©, je n\'ai pas pu gÃ©nÃ©rer votre histoire maintenant. Veuillez rÃ©essayer.',
        
        // IntÃ©rÃªts
        'interests.renewable': 'Ã‰nergie Renouvelable',
        'interests.ocean': 'Conservation OcÃ©anique',
        'interests.forest': 'Protection ForestiÃ¨re',
        'interests.sustainable': 'Vie Durable',
        'interests.science': 'Science Climatique',
        'interests.wildlife': 'Protection de la Faune',
        
        // Groupes d\'Ã‚ge
        'age.young': '13-15 ans',
        'age.teen': '16-18 ans',
        'age.young-adult': '19-25 ans',
        'age.educator': 'Je suis Ã©ducateur',
        
        // Actions
        'actions.share': 'Partager l\'Histoire',
        'actions.save': 'Sauvegarder l\'Histoire',
        'actions.more': 'Plus d\'Histoires',
        'actions.walked': 'MarchÃ© au lieu de conduire',
        'actions.recycled': 'RecyclÃ© des dÃ©chets',
        'actions.energy': 'UtilisÃ© des appareils Ã©conomes',
        'actions.water': 'ConservÃ© l\'eau',
        'actions.plant': 'PlantÃ© un arbre',
        'actions.public': 'UtilisÃ© les transports publics',
        
        // Suivi d\'Impact
        'tracker.title': 'Votre Impact Climatique',
        'tracker.description': 'Suivez vos actions quotidiennes et voyez leur impact environnemental',
        'tracker.carbon': 'COâ‚‚ Ã‰conomisÃ© Aujourd\'hui',
        'tracker.water': 'Eau ConservÃ©e',
        'tracker.energy': 'Ã‰nergie Ã‰conomisÃ©e',
        'tracker.score': 'Score Ã‰co',
        'tracker.log.title': 'Enregistrez Vos Actions Climatiques',
        'tracker.progress': 'Votre ProgrÃ¨s Hebdomadaire',
        
        // Section d\'Apprentissage
        'learn.title': 'Centre d\'Apprentissage Climatique',
        'learn.description': 'LeÃ§ons interactives et quiz alimentÃ©s par l\'IA',
        'learn.basics': 'Bases du Climat',
        'learn.solutions': 'Solutions Climatiques',
        'learn.impact': 'Impact Global',
        'learn.action': 'Passer Ã  l\'Action',
        'learn.current.title': 'Introduction au Changement Climatique',
        'learn.current.intro': 'Le changement climatique fait rÃ©fÃ©rence aux changements Ã  long terme des tempÃ©ratures mondiales et des modÃ¨les mÃ©tÃ©orologiques. Bien que des variations naturelles se produisent, les preuves scientifiques montrent que les activitÃ©s humaines depuis la rÃ©volution industrielle ont Ã©tÃ© le principal moteur des changements climatiques rÃ©cents.',
        'learn.quiz': 'Faire le Quiz',
        'learn.next': 'LeÃ§on Suivante',
        
        // Section CommunautÃ©
        'community.title': 'CommunautÃ© des Champions Climatiques',
        'community.description': 'Connectez-vous avec vos pairs et partagez votre parcours climatique',
        'community.leaderboard': 'ðŸ† Meilleurs Champions Climatiques',
        'community.challenges': 'ðŸŽ¯ DÃ©fis Hebdomadaires',
        'community.share': 'Partagez Votre Histoire',
        'community.share.placeholder': 'Partagez votre histoire d\'action climatique avec la communautÃ©...',
        'community.share.btn': 'Partager l\'Histoire',
        
        // DÃ©fis
        'challenges.bike': 'Semaine du VÃ©lo Ã  l\'Ã‰cole',
        'challenges.bike.desc': 'Utilisez le vÃ©lo au lieu du transport motorisÃ©',
        'challenges.plant': 'Planter pour la PlanÃ¨te',
        'challenges.plant.desc': 'Aidez Ã  planter 1000 arbres ce mois-ci',
        
        // Assistant Chat
        'chat.welcome': 'Bonjour ! Je suis votre assistant IA climatique. Posez-moi n\'importe quelle question sur le changement climatique, la durabilitÃ© ou l\'action environnementale !',
        'chat.placeholder': 'Posez-moi des questions sur le changement climatique...',
        'chat.thinking': 'RÃ©flexion...',
        'chat.error': 'DÃ©solÃ©, je n\'ai pas pu traiter votre message. Veuillez rÃ©essayer.',
        
        // DonnÃ©es MÃ©tÃ©orologiques et Climatiques
        'weather.temperature': 'TempÃ©rature',
        'weather.humidity': 'HumiditÃ©',
        'weather.condition': 'Condition',
        'weather.loading': 'Chargement des donnÃ©es mÃ©tÃ©o...',
        'weather.error': 'Impossible de charger les donnÃ©es mÃ©tÃ©o',
        
        // Messages de SuccÃ¨s
        'success.story.shared': 'Votre histoire a Ã©tÃ© partagÃ©e avec la communautÃ© !',
        'success.story.saved': 'Histoire sauvegardÃ©e dans votre collection !',
        'success.action.logged': 'Excellent travail ! Votre action climatique a Ã©tÃ© enregistrÃ©e.',
        'success.location.found': 'Localisation dÃ©tectÃ©e avec succÃ¨s !',
        
        // Messages d\'Erreur
        'error.location.denied': 'AccÃ¨s Ã  la localisation refusÃ©. Veuillez entrer votre ville manuellement.',
        'error.location.unavailable': 'Impossible de dÃ©terminer votre localisation.',
        'error.network': 'Erreur rÃ©seau. Veuillez vÃ©rifier votre connexion.',
        'error.general': 'Quelque chose s\'est mal passÃ©. Veuillez rÃ©essayer.',
    }
};

// Translation Management Class
class TranslationManager {
    constructor() {
        this.currentLanguage = 'en';
        this.translations = translations;
        this.init();
    }
    
    init() {
        // Detect browser language
        const browserLang = navigator.language.slice(0, 2);
        if (this.translations[browserLang]) {
            this.currentLanguage = browserLang;
        }
        
        // Check for saved language preference
        const savedLang = localStorage.getItem('climate-ai-language');
        if (savedLang && this.translations[savedLang]) {
            this.currentLanguage = savedLang;
        }
        
        // Set up language selector
        this.setupLanguageSelector();
        
        // Apply initial translations
        this.applyTranslations();
    }
    
    setupLanguageSelector() {
        const selector = document.getElementById('language-select');
        if (selector) {
            selector.value = this.currentLanguage;
            selector.addEventListener('change', (e) => {
                this.setLanguage(e.target.value);
            });
        }
    }
    
    setLanguage(languageCode) {
        if (this.translations[languageCode]) {
            this.currentLanguage = languageCode;
            localStorage.setItem('climate-ai-language', languageCode);
            this.applyTranslations();
            
            // Update language selector
            const selector = document.getElementById('language-select');
            if (selector) {
                selector.value = languageCode;
            }
            
            // Trigger custom event for other components
            document.dispatchEvent(new CustomEvent('languageChanged', {
                detail: { language: languageCode }
            }));
        }
    }
    
    translate(key, fallback = null) {
        const translation = this.translations[this.currentLanguage]?.[key] || 
                          this.translations['en']?.[key] || 
                          fallback || 
                          key;
        return translation;
    }
    
    applyTranslations() {
        // Translate elements with data-translate attribute
        const elements = document.querySelectorAll('[data-translate]');
        elements.forEach(element => {
            const key = element.getAttribute('data-translate');
            const translation = this.translate(key);
            
            if (element.tagName === 'INPUT' && element.type === 'text') {
                element.placeholder = translation;
            } else if (element.tagName === 'TEXTAREA') {
                element.placeholder = translation;
            } else {
                element.textContent = translation;
            }
        });
        
        // Translate placeholders with data-translate-placeholder attribute
        const placeholderElements = document.querySelectorAll('[data-translate-placeholder]');
        placeholderElements.forEach(element => {
            const key = element.getAttribute('data-translate-placeholder');
            const translation = this.translate(key);
            element.placeholder = translation;
        });
        
        // Update page title and meta description
        document.title = this.translate('meta.title', 'CliMate AI - Your Personal Climate Education Companion');
        const metaDescription = document.querySelector('meta[name="description"]');
        if (metaDescription) {
            metaDescription.content = this.translate('meta.description', 'AI-powered personalized climate education platform');
        }
    }
    
    // Format numbers and dates according to locale
    formatNumber(number) {
        try {
            return new Intl.NumberFormat(this.getLocale()).format(number);
        } catch (e) {
            return number.toString();
        }
    }
    
    formatDate(date) {
        try {
            return new Intl.DateTimeFormat(this.getLocale()).format(new Date(date));
        } catch (e) {
            return date.toString();
        }
    }
    
    getLocale() {
        const localeMap = {
            'en': 'en-US',
            'es': 'es-ES',
            'fr': 'fr-FR'
        };
        return localeMap[this.currentLanguage] || 'en-US';
    }
    
    // Get current language code
    getCurrentLanguage() {
        return this.currentLanguage;
    }
    
    // Check if RTL language
    isRTL() {
        const rtlLanguages = ['ar', 'he', 'fa', 'ur'];
        return rtlLanguages.includes(this.currentLanguage);
    }
    
    // Get language name in native script
    getLanguageName(code = null) {
        const lang = code || this.currentLanguage;
        const names = {
            'en': 'English',
            'es': 'EspaÃ±ol',
            'fr': 'FranÃ§ais'
        };
        return names[lang] || lang;
    }
}

// Initialize translation manager when DOM is loaded
let translationManager;

document.addEventListener('DOMContentLoaded', () => {
    translationManager = new TranslationManager();
});

// Export for use in other modules
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { TranslationManager, translations };
}

// Global function for easy access
function translate(key, fallback = null) {
    if (translationManager) {
        return translationManager.translate(key, fallback);
    }
    return fallback || key;
}

function setLanguage(languageCode) {
    if (translationManager) {
        translationManager.setLanguage(languageCode);
    }
}