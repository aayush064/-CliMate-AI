// CliMate AI - Multilingual Translation System
// Comprehensive translation data for climate education platform

const translations = {
    // English (Default)
    en: {
        // Navigation and Header
        'nav.stories': 'Stories',
        'nav.impact': 'Impact',
        'nav.learn': 'Learn',
        'nav.community': 'Community',
        
        // Hero Section
        'hero.title': 'Discover Your Climate Story with AI',
        'hero.subtitle': 'Get personalized climate education, track your environmental impact, and join a community of climate champions',
        'hero.cta': 'Start Your Climate Journey',
        
        // Storyteller Section
        'storyteller.title': 'AI Climate Storyteller',
        'storyteller.description': 'Get personalized climate stories based on your location and interests',
        'storyteller.location.label': 'Your Location',
        'storyteller.location.placeholder': 'Enter your city or allow location access',
        'storyteller.interests.label': 'What interests you most?',
        'storyteller.age.label': 'Age Group',
        'storyteller.generate': 'Generate My Climate Story',
        'storyteller.placeholder': 'Your personalized climate story will appear here...',
        'storyteller.loading': 'Creating your personalized climate story...',
        'storyteller.error': 'Sorry, I couldn\'t generate your story right now. Please try again.',
        
        // Interests
        'interests.renewable': 'Renewable Energy',
        'interests.ocean': 'Ocean Conservation',
        'interests.forest': 'Forest Protection',
        'interests.sustainable': 'Sustainable Living',
        'interests.science': 'Climate Science',
        'interests.wildlife': 'Wildlife Protection',
        
        // Age Groups
        'age.young': '13-15 years',
        'age.teen': '16-18 years',
        'age.young-adult': '19-25 years',
        'age.educator': 'I\'m an educator',
        
        // Actions
        'actions.share': 'Share Story',
        'actions.save': 'Save Story',
        'actions.more': 'More Stories',
        'actions.walked': 'Walked instead of driving',
        'actions.recycled': 'Recycled waste',
        'actions.energy': 'Used energy-efficient appliances',
        'actions.water': 'Conserved water',
        'actions.plant': 'Planted a tree',
        'actions.public': 'Used public transport',
        
        // Impact Tracker
        'tracker.title': 'Your Climate Impact',
        'tracker.description': 'Track your daily actions and see their environmental impact',
        'tracker.carbon': 'CO‚ÇÇ Saved Today',
        'tracker.water': 'Water Conserved',
        'tracker.energy': 'Energy Saved',
        'tracker.score': 'Eco Score',
        'tracker.log.title': 'Log Your Climate Actions',
        'tracker.progress': 'Your Weekly Progress',
        
        // Learning Section
        'learn.title': 'Climate Learning Hub',
        'learn.description': 'Interactive lessons and quizzes powered by AI',
        'learn.basics': 'Climate Basics',
        'learn.solutions': 'Climate Solutions',
        'learn.impact': 'Global Impact',
        'learn.action': 'Take Action',
        'learn.current.title': 'Introduction to Climate Change',
        'learn.current.intro': 'Climate change refers to long-term shifts in global temperatures and weather patterns. While natural variations occur, scientific evidence shows that human activities since the Industrial Revolution have been the primary driver of recent climate changes.',
        'learn.quiz': 'Take Quiz',
        'learn.next': 'Next Lesson',
        
        // Community Section
        'community.title': 'Climate Champions Community',
        'community.description': 'Connect with peers and share your climate journey',
        'community.leaderboard': 'üèÜ Top Climate Champions',
        'community.challenges': 'üéØ Weekly Challenges',
        'community.share': 'Share Your Story',
        'community.share.placeholder': 'Share your climate action story with the community...',
        'community.share.btn': 'Share Story',
        
        // Challenges
        'challenges.bike': 'Bike to School Week',
        'challenges.bike.desc': 'Cycle instead of taking motorized transport',
        'challenges.plant': 'Plant for the Planet',
        'challenges.plant.desc': 'Help plant 1000 trees this month',
        
        // Chat Assistant
        'chat.welcome': 'Hi! I\'m your Climate AI assistant. Ask me anything about climate change, sustainability, or environmental action!',
        'chat.placeholder': 'Ask me about climate change...',
        'chat.thinking': 'Thinking...',
        'chat.error': 'Sorry, I couldn\'t process your message. Please try again.',
        
        // Weather and Climate Data
        'weather.temperature': 'Temperature',
        'weather.humidity': 'Humidity',
        'weather.condition': 'Condition',
        'weather.loading': 'Loading weather data...',
        'weather.error': 'Unable to load weather data',
        
        // Success Messages
        'success.story.shared': 'Your story has been shared with the community!',
        'success.story.saved': 'Story saved to your collection!',
        'success.action.logged': 'Great job! Your climate action has been logged.',
        'success.location.found': 'Location detected successfully!',
        
        // Error Messages
        'error.location.denied': 'Location access denied. Please enter your city manually.',
        'error.location.unavailable': 'Unable to determine your location.',
        'error.network': 'Network error. Please check your connection.',
        'error.general': 'Something went wrong. Please try again.',
    },
    
    // Spanish
    es: {
        // Navegaci√≥n y Encabezado
        'nav.stories': 'Historias',
        'nav.impact': 'Impacto',
        'nav.learn': 'Aprender',
        'nav.community': 'Comunidad',
        
        // Secci√≥n Principal
        'hero.title': 'Descubre Tu Historia Clim√°tica con IA',
        'hero.subtitle': 'Obt√©n educaci√≥n clim√°tica personalizada, rastrea tu impacto ambiental y √∫nete a una comunidad de campeones del clima',
        'hero.cta': 'Comienza Tu Viaje Clim√°tico',
        
        // Secci√≥n del Narrador
        'storyteller.title': 'Narrador Clim√°tico con IA',
        'storyteller.description': 'Obt√©n historias clim√°ticas personalizadas basadas en tu ubicaci√≥n e intereses',
        'storyteller.location.label': 'Tu Ubicaci√≥n',
        'storyteller.location.placeholder': 'Ingresa tu ciudad o permite acceso a ubicaci√≥n',
        'storyteller.interests.label': '¬øQu√© te interesa m√°s?',
        'storyteller.age.label': 'Grupo de Edad',
        'storyteller.generate': 'Generar Mi Historia Clim√°tica',
        'storyteller.placeholder': 'Tu historia clim√°tica personalizada aparecer√° aqu√≠...',
        'storyteller.loading': 'Creando tu historia clim√°tica personalizada...',
        'storyteller.error': 'Lo siento, no pude generar tu historia ahora. Por favor intenta de nuevo.',
        
        // Intereses
        'interests.renewable': 'Energ√≠a Renovable',
        'interests.ocean': 'Conservaci√≥n Oce√°nica',
        'interests.forest': 'Protecci√≥n Forestal',
        'interests.sustainable': 'Vida Sostenible',
        'interests.science': 'Ciencia Clim√°tica',
        'interests.wildlife': 'Protecci√≥n de Vida Silvestre',
        
        // Grupos de Edad
        'age.young': '13-15 a√±os',
        'age.teen': '16-18 a√±os',
        'age.young-adult': '19-25 a√±os',
        'age.educator': 'Soy educador',
        
        // Acciones
        'actions.share': 'Compartir Historia',
        'actions.save': 'Guardar Historia',
        'actions.more': 'M√°s Historias',
        'actions.walked': 'Camin√© en lugar de conducir',
        'actions.recycled': 'Recicl√© desechos',
        'actions.energy': 'Us√© electrodom√©sticos eficientes',
        'actions.water': 'Conserv√© agua',
        'actions.plant': 'Plant√© un √°rbol',
        'actions.public': 'Us√© transporte p√∫blico',
        
        // Rastreador de Impacto
        'tracker.title': 'Tu Impacto Clim√°tico',
        'tracker.description': 'Rastrea tus acciones diarias y ve su impacto ambiental',
        'tracker.carbon': 'CO‚ÇÇ Ahorrado Hoy',
        'tracker.water': 'Agua Conservada',
        'tracker.energy': 'Energ√≠a Ahorrada',
        'tracker.score': 'Puntuaci√≥n Eco',
        'tracker.log.title': 'Registra Tus Acciones Clim√°ticas',
        'tracker.progress': 'Tu Progreso Semanal',
        
        // Secci√≥n de Aprendizaje
        'learn.title': 'Centro de Aprendizaje Clim√°tico',
        'learn.description': 'Lecciones interactivas y cuestionarios impulsados por IA',
        'learn.basics': 'Conceptos B√°sicos del Clima',
        'learn.solutions': 'Soluciones Clim√°ticas',
        'learn.impact': 'Impacto Global',
        'learn.action': 'Tomar Acci√≥n',
        'learn.current.title': 'Introducci√≥n al Cambio Clim√°tico',
        'learn.current.intro': 'El cambio clim√°tico se refiere a cambios a largo plazo en las temperaturas globales y los patrones clim√°ticos. Aunque ocurren variaciones naturales, la evidencia cient√≠fica muestra que las actividades humanas desde la Revoluci√≥n Industrial han sido el principal impulsor de los cambios clim√°ticos recientes.',
        'learn.quiz': 'Tomar Cuestionario',
        'learn.next': 'Siguiente Lecci√≥n',
        
        // Secci√≥n de Comunidad
        'community.title': 'Comunidad de Campeones Clim√°ticos',
        'community.description': 'Con√©ctate con compa√±eros y comparte tu viaje clim√°tico',
        'community.leaderboard': 'üèÜ Mejores Campeones Clim√°ticos',
        'community.challenges': 'üéØ Desaf√≠os Semanales',
        'community.share': 'Comparte Tu Historia',
        'community.share.placeholder': 'Comparte tu historia de acci√≥n clim√°tica con la comunidad...',
        'community.share.btn': 'Compartir Historia',
        
        // Desaf√≠os
        'challenges.bike': 'Semana de Bicicleta a la Escuela',
        'challenges.bike.desc': 'Usa bicicleta en lugar de transporte motorizado',
        'challenges.plant': 'Plantar por el Planeta',
        'challenges.plant.desc': 'Ayuda a plantar 1000 √°rboles este mes',
        
        // Asistente de Chat
        'chat.welcome': '¬°Hola! Soy tu asistente de IA clim√°tica. ¬°Preg√∫ntame cualquier cosa sobre cambio clim√°tico, sostenibilidad o acci√≥n ambiental!',
        'chat.placeholder': 'Preg√∫ntame sobre cambio clim√°tico...',
        'chat.thinking': 'Pensando...',
        'chat.error': 'Lo siento, no pude procesar tu mensaje. Por favor intenta de nuevo.',
        
        // Datos Clim√°ticos y del Tiempo
        'weather.temperature': 'Temperatura',
        'weather.humidity': 'Humedad',
        'weather.condition': 'Condici√≥n',
        'weather.loading': 'Cargando datos del tiempo...',
        'weather.error': 'No se pueden cargar los datos del tiempo',
        
        // Mensajes de √âxito
        'success.story.shared': '¬°Tu historia ha sido compartida con la comunidad!',
        'success.story.saved': '¬°Historia guardada en tu colecci√≥n!',
        'success.action.logged': '¬°Excelente trabajo! Tu acci√≥n clim√°tica ha sido registrada.',
        'success.location.found': '¬°Ubicaci√≥n detectada exitosamente!',
        
        // Mensajes de Error
        'error.location.denied': 'Acceso a ubicaci√≥n denegado. Por favor ingresa tu ciudad manualmente.',
        'error.location.unavailable': 'No se puede determinar tu ubicaci√≥n.',
        'error.network': 'Error de red. Por favor verifica tu conexi√≥n.',
        'error.general': 'Algo sali√≥ mal. Por favor intenta de nuevo.',
    },
    
    // French
    fr: {
        // Navigation et En-t√™te
        'nav.stories': 'Histoires',
        'nav.impact': 'Impact',
        'nav.learn': 'Apprendre',
        'nav.community': 'Communaut√©',
        
        // Section Principale
        'hero.title': 'D√©couvrez Votre Histoire Climatique avec l\'IA',
        'hero.subtitle': 'Obtenez une √©ducation climatique personnalis√©e, suivez votre impact environnemental et rejoignez une communaut√© de champions du climat',
        'hero.cta': 'Commencez Votre Parcours Climatique',
        
        // Section du Narrateur
        'storyteller.title': 'Narrateur Climatique IA',
        'storyteller.description': 'Obtenez des histoires climatiques personnalis√©es bas√©es sur votre localisation et vos int√©r√™ts',
        'storyteller.location.label': 'Votre Localisation',
        'storyteller.location.placeholder': 'Entrez votre ville ou autorisez l\'acc√®s √† la localisation',
        'storyteller.interests.label': 'Qu\'est-ce qui vous int√©resse le plus ?',
        'storyteller.age.label': 'Groupe d\'√Çge',
        'storyteller.generate': 'G√©n√©rer Mon Histoire Climatique',
        'storyteller.placeholder': 'Votre histoire climatique personnalis√©e appara√Ætra ici...',
        'storyteller.loading': 'Cr√©ation de votre histoire climatique personnalis√©e...',
        'storyteller.error': 'D√©sol√©, je n\'ai pas pu g√©n√©rer votre histoire maintenant. Veuillez r√©essayer.',
        
        // Int√©r√™ts
        'interests.renewable': '√ânergie Renouvelable',
        'interests.ocean': 'Conservation Oc√©anique',
        'interests.forest': 'Protection Foresti√®re',
        'interests.sustainable': 'Vie Durable',
        'interests.science': 'Science Climatique',
        'interests.wildlife': 'Protection de la Faune',
        
        // Groupes d\'√Çge
        'age.young': '13-15 ans',
        'age.teen': '16-18 ans',
        'age.young-adult': '19-25 ans',
        'age.educator': 'Je suis √©ducateur',
        
        // Actions
        'actions.share': 'Partager l\'Histoire',
        'actions.save': 'Sauvegarder l\'Histoire',
        'actions.more': 'Plus d\'Histoires',
        'actions.walked': 'March√© au lieu de conduire',
        'actions.recycled': 'Recycl√© des d√©chets',
        'actions.energy': 'Utilis√© des appareils √©conomes',
        'actions.water': 'Conserv√© l\'eau',
        'actions.plant': 'Plant√© un arbre',
        'actions.public': 'Utilis√© les transports publics',
        
        // Suivi d\'Impact
        'tracker.title': 'Votre Impact Climatique',
        'tracker.description': 'Suivez vos actions quotidiennes et voyez leur impact environnemental',
        'tracker.carbon': 'CO‚ÇÇ √âconomis√© Aujourd\'hui',
        'tracker.water': 'Eau Conserv√©e',
        'tracker.energy': '√ânergie √âconomis√©e',
        'tracker.score': 'Score √âco',
        'tracker.log.title': 'Enregistrez Vos Actions Climatiques',
        'tracker.progress': 'Votre Progr√®s Hebdomadaire',
        
        // Section d\'Apprentissage
        'learn.title': 'Centre d\'Apprentissage Climatique',
        'learn.description': 'Le√ßons interactives et quiz aliment√©s par l\'IA',
        'learn.basics': 'Bases du Climat',
        'learn.solutions': 'Solutions Climatiques',
        'learn.impact': 'Impact Global',
        'learn.action': 'Passer √† l\'Action',
        'learn.current.title': 'Introduction au Changement Climatique',
        'learn.current.intro': 'Le changement climatique fait r√©f√©rence aux changements √† long terme des temp√©ratures mondiales et des mod√®les m√©t√©orologiques. Bien que des variations naturelles se produisent, les preuves scientifiques montrent que les activit√©s humaines depuis la r√©volution industrielle ont √©t√© le principal moteur des changements climatiques r√©cents.',
        'learn.quiz': 'Faire le Quiz',
        'learn.next': 'Le√ßon Suivante',
        
        // Section Communaut√©
        'community.title': 'Communaut√© des Champions Climatiques',
        'community.description': 'Connectez-vous avec vos pairs et partagez votre parcours climatique',
        'community.leaderboard': 'üèÜ Meilleurs Champions Climatiques',
        'community.challenges': 'üéØ D√©fis Hebdomadaires',
        'community.share': 'Partagez Votre Histoire',
        'community.share.placeholder': 'Partagez votre histoire d\'action climatique avec la communaut√©...',
        'community.share.btn': 'Partager l\'Histoire',
        
        // D√©fis
        'challenges.bike': 'Semaine du V√©lo √† l\'√âcole',
        'challenges.bike.desc': 'Utilisez le v√©lo au lieu du transport motoris√©',
        'challenges.plant': 'Planter pour la Plan√®te',
        'challenges.plant.desc': 'Aidez √† planter 1000 arbres ce mois-ci',
        
        // Assistant Chat
        'chat.welcome': 'Bonjour ! Je suis votre assistant IA climatique. Posez-moi n\'importe quelle question sur le changement climatique, la durabilit√© ou l\'action environnementale !',
        'chat.placeholder': 'Posez-moi des questions sur le changement climatique...',
        'chat.thinking': 'R√©flexion...',
        'chat.error': 'D√©sol√©, je n\'ai pas pu traiter votre message. Veuillez r√©essayer.',
        
        // Donn√©es M√©t√©orologiques et Climatiques
        'weather.temperature': 'Temp√©rature',
        'weather.humidity': 'Humidit√©',
        'weather.condition': 'Condition',
        'weather.loading': 'Chargement des donn√©es m√©t√©o...',
        'weather.error': 'Impossible de charger les donn√©es m√©t√©o',
        
        // Messages de Succ√®s
        'success.story.shared': 'Votre histoire a √©t√© partag√©e avec la communaut√© !',
        'success.story.saved': 'Histoire sauvegard√©e dans votre collection !',
        'success.action.logged': 'Excellent travail ! Votre action climatique a √©t√© enregistr√©e.',
        'success.location.found': 'Localisation d√©tect√©e avec succ√®s !',
        
        // Messages d\'Erreur
        'error.location.denied': 'Acc√®s √† la localisation refus√©. Veuillez entrer votre ville manuellement.',
        'error.location.unavailable': 'Impossible de d√©terminer votre localisation.',
        'error.network': 'Erreur r√©seau. Veuillez v√©rifier votre connexion.',
        'error.general': 'Quelque chose s\'est mal pass√©. Veuillez r√©essayer.',
    }
};

// Translation Management Class
class TranslationManager {
    constructor() {
        this.currentLanguage = 'en';
        this.translations = translations;
        this.init();
    }
    
    init() {
        // Detect browser language
        const browserLang = navigator.language.slice(0, 2);
        if (this.translations[browserLang]) {
            this.currentLanguage = browserLang;
        }
        
        // Check for saved language preference
        const savedLang = localStorage.getItem('climate-ai-language');
        if (savedLang && this.translations[savedLang]) {
            this.currentLanguage = savedLang;
        }
        
        // Set up language selector
        this.setupLanguageSelector();
        
        // Apply initial translations
        this.applyTranslations();
    }
    
    setupLanguageSelector() {
        const selector = document.getElementById('language-select');
        if (selector) {
            selector.value = this.currentLanguage;
            selector.addEventListener('change', (e) => {
                this.setLanguage(e.target.value);
            });
        }
    }
    
    setLanguage(languageCode) {
        if (this.translations[languageCode]) {
            this.currentLanguage = languageCode;
            localStorage.setItem('climate-ai-language', languageCode);
            this.applyTranslations();
            
            // Update language selector
            const selector = document.getElementById('language-select');
            if (selector) {
                selector.value = languageCode;
            }
            
            // Trigger custom event for other components
            document.dispatchEvent(new CustomEvent('languageChanged', {
                detail: { language: languageCode }
            }));
        }
    }
    
    translate(key, fallback = null) {
        const translation = this.translations[this.currentLanguage]?.[key] || 
                          this.translations['en']?.[key] || 
                          fallback || 
                          key;
        return translation;
    }
    
    applyTranslations() {
        // Translate elements with data-translate attribute
        const elements = document.querySelectorAll('[data-translate]');
        elements.forEach(element => {
            const key = element.getAttribute('data-translate');
            const translation = this.translate(key);
            
            if (element.tagName === 'INPUT' && element.type === 'text') {
                element.placeholder = translation;
            } else if (element.tagName === 'TEXTAREA') {
                element.placeholder = translation;
            } else {
                element.textContent = translation;
            }
        });
        
        // Translate placeholders with data-translate-placeholder attribute
        const placeholderElements = document.querySelectorAll('[data-translate-placeholder]');
        placeholderElements.forEach(element => {
            const key = element.getAttribute('data-translate-placeholder');
            const translation = this.translate(key);
            element.placeholder = translation;
        });
        
        // Update page title and meta description
        document.title = this.translate('meta.title', 'CliMate AI - Your Personal Climate Education Companion');
        const metaDescription = document.querySelector('meta[name="description"]');
        if (metaDescription) {
            metaDescription.content = this.translate('meta.description', 'AI-powered personalized climate education platform');
        }
    }
    
    // Format numbers and dates according to locale
    formatNumber(number) {
        try {
            return new Intl.NumberFormat(this.getLocale()).format(number);
        } catch (e) {
            return number.toString();
        }
    }
    
    formatDate(date) {
        try {
            return new Intl.DateTimeFormat(this.getLocale()).format(new Date(date));
        } catch (e) {
            return date.toString();
        }
    }
    
    getLocale() {
        const localeMap = {
            'en': 'en-US',
            'es': 'es-ES',
            'fr': 'fr-FR'
        };
        return localeMap[this.currentLanguage] || 'en-US';
    }
    
    // Get current language code
    getCurrentLanguage() {
        return this.currentLanguage;
    }
    
    // Check if RTL language
    isRTL() {
        const rtlLanguages = ['ar', 'he', 'fa', 'ur'];
        return rtlLanguages.includes(this.currentLanguage);
    }
    
    // Get language name in native script
    getLanguageName(code = null) {
        const lang = code || this.currentLanguage;
        const names = {
            'en': 'English',
            'es': 'Espa√±ol',
            'fr': 'Fran√ßais'
        };
        return names[lang] || lang;
    }
}

// Initialize translation manager when DOM is loaded
let translationManager;

document.addEventListener('DOMContentLoaded', () => {
    translationManager = new TranslationManager();
});

// Export for use in other modules
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { TranslationManager, translations };
}

// Global function for easy access
function translate(key, fallback = null) {
    if (translationManager) {
        return translationManager.translate(key, fallback);
    }
    return fallback || key;
}

function setLanguage(languageCode) {
    if (translationManager) {
        translationManager.setLanguage(languageCode);
    }
}